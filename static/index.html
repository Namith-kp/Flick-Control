<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Flick Control</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Kanit:wght@500&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@500;600&display=swap" />
    <link rel="stylesheet" href="./style.css">
    <!-- <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}"> -->    
  </head>
  <body>
    <div class="main-container">
      <div class="navigation">
        <div class="navigation-1">
          <span class="flick-control">Flick Control</span>
        </div>
        <div class="navigation-2">
          <div class="navigation-bar">
            <div class="nav-item">
              <div class="icon-container">
                <div class="state-layer">
                  <div class="icon"><div class="icon-3"></div></div>
                </div>
              </div>
              <span class="label-text">Guide</span>
            </div>
            <div class="nav-item-4">
              <div class="icon-container-5">
                <div class="state-layer-6">
                  <div class="icon-7"><div class="icon-8"></div></div>
                </div>
              </div>
              <span class="label-text-9">About Us</span>
            </div>
            <div class="nav-item-a">
              <div class="icon-container-b">
                <div class="state-layer-c">
                  <div class="icon-d"><div class="icon-e"></div></div>
                </div>
              </div>
              <span class="label-text-f">Features</span>
            </div>
            <div class="nav-item-10">
              <div class="icon-container-11">
                <div class="state-layer-12">
                  <div class="icon-13"><div class="icon-14"></div></div>
                </div>
              </div>
              <span class="learn-more">Learn More</span>
            </div>
          </div>
          <span class="flick-control-15">Flick Control</span>
        </div>
        <div class="navigation-16">
          <div class="navigation-bar-17">
            <div class="nav-item-18">
              <div class="icon-container-19">
                <a href="landing.html" title="Home">
                  <div class="state-layer-1a">
                    <div class="icon-1b"><div class="icon-1c" style="background: url('./images/f463641e-121d-4643-99c3-a2933650d9c6.png') no-repeat center; background-size: 100% 100%;"></div></div>
                  </div>
                </a>
              </div>
              <span class="home">Home</span>
            </div>
            <div class="nav-item-1d">
              <div class="icon-container-1e">
                <a href="landing.html#Features" title="Home">
                  <div class="state-layer-1f">
                    <div class="icon-20"><div class="icon-21"></div></div>
                  </div>
                </a>
              </div>
              <span class="features">Features</span>
            </div>
            <div class="nav-item-22">
              <div class="icon-container-23">
                <a href="#Footer" title="Footer">
                  <div class="state-layer-24">
                    <div class="icon-25"><div class="icon-26"></div></div>
                  </div>
              </a>
              </div>
              <span class="about-us">About Us</span>
            </div>
          </div>
          <span class="flick-control-27">Flick Control</span>
        </div>
        <div class="items">
          <span class="page">Page</span><span class="page-28">Page</span
          ><span class="page-29">Page</span>
          <div class="button"><span class="button-2a">Button</span></div>
        </div>
        <span class="site-name">Site name</span>
      </div>
      <span class="live-gesture-detection">Live Gesture Detection in Action</span>
      <div class="navigation-footer" id="Footer">
        <div class="divider"></div>
        <div class="flex-row-be">
          <div class="navigation-footer-2b">
            <div class="flex-column-cd">
              <div class="divider-2c"></div>
              <span class="flick-control-2d">Flick Control</span>
              <div class="items-2e">
                <span class="contact-us">Contact Us</span>
                <span class="email">namithkp.22is@saividya.ac.in</span>
                <span class="phone">+08 0258 047</span>
              </div>
              <div class="icon-2f"></div>
            </div>
            <div class="social-icons">
              <div class="buttons-icon">
                <div class="icon-30"><div class="icon-31"></div></div>
              </div>
              <!-- <div class="buttons-icon-32">
                <div class="icon-33"><div class="icon-34"></div></div>
              </div> -->
              <div class="buttons-icon-35">
                <div class="icon-36"><div class="icon-37"></div></div>
              </div>
              <div class="buttons-icon-38">
                <div class="icon-39"><div class="icon-3a"></div></div>
              </div>
            </div>
          </div>
          <span class="follow-us-on">Follow us on :</span>
          <div class="phone-4a"><div class="icon-4b"></div></div>
          <div class="social-icons-4c">
            <div class="buttons-icon-4d">
              <div class="icon-4e"><div class="icon-4f"></div></div>
            </div>
            <div class="buttons-icon-50">
              <div class="icon-51"><button class="icon-52"></button></div>
            </div>
            <div class="buttons-icon-53">
              <div class="icon-54"><div class="icon-55"></div></div>
            </div>
            <div class="buttons-icon-56">
              <div class="icon-57"><div class="icon-58"></div></div>
            </div>
          </div>
        </div>
      </div>
      <div class="card">
        <!-- <img src="./images/7f12ea1300756f144a0fb5daaf68dbfc01103a46.png" alt="Gesture Control Video Feed"> -->
        <img id="video-feed" src="http://localhost:8000/video_feed" alt="Gesture Control Video Feed">      
      </div>
      <div class="card1">
        <span class="interactive-guide1">Try This</span>
            <span class="position-hand-camera1">Perform these gesture to take control of<br> your devices</span>
        <img src="./images/lv_0_20241125171807.gif" alt="Gesture Control Video Feed">
        <div class = "button2">
          <button onclick="switchCamera('webcam')"><a style="text-decoration: none;" class="try-demo">Webcam</a></button>
          <button onclick="switchCamera('usbcam')"><a style="text-decoration: none;" class="try-demo">Mobile Cam</a></button>
          <button onclick="switchCamera('ipcam')"><a style="text-decoration: none;" class="try-demo">External Cam</a></button>
        </div> 
      </div>
      <div class="frame">
        <h3>Manual Control</h3> 
        <div class="led-controls">
          <!-- <h3>Manual Control</h3>  -->
          <button  id="led2" onclick="toggleLed(2)" class="try-demo">LED 1</button>
          <button  id="led3" onclick="toggleLed(3)" class="try-demo">LED 2</button>
          <button  id="led4" onclick="toggleLed(4)" class="try-demo">LED 3</button>
          <button  id="led5" onclick="toggleLed(5)" class="try-demo">LED 4</button>
          <button  id="led1" onclick="toggleLed(1)" class="try-demo">LED 5</button>
        </div>
        <div class="card-59">
          <div class="copy">
            <span class="interactive-guide">Interactive Guide</span>
            <span class="position-hand-camera"
              >Position your hand in front of the camera. Perform a recognized
              gesture. Watch the command executed live.</span>
          </div>
          <div class="image-5a"></div>
        </div>
        
      </div>
    </div>
    <footer>
      <p>&copy; CopyRight 2024. All rights reserved - Design & Developed by Namith K P</p>
    </footer>
    <script>
      const socket = new WebSocket('ws://localhost:8765');
      const canvas = document.getElementById('videoCanvas');
      const ctx = canvas.getContext('2d');

      socket.onopen = function() {
          console.log('WebSocket connection established');
        };

      socket.onmessage = function(event) {
          const data = JSON.parse(event.data);
          console.log('Received data:', data); // Log received data for debugging 
          if (data.type === 'frame') {
              const img = new Image();
              img.onload = function() {
                  ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
              };
              img.src = 'data:image/jpeg;base64,' + data.data;
          } else if (data.type === 'led_status') {
              console.log('LED States:', data.led_states); 
              updateLedStatus(data.led_states);
        }
      };

      socket.onerror = function(error) {
          console.error('WebSocket Error:', error);
      };

      function switchCamera(cameraName) {
          socket.send(JSON.stringify({
              type: 'switch_camera',
              camera: cameraName
          }));
      }

      function toggleLed(led) {
        console.log(`Toggling LED ${led}`);
        socket.send(JSON.stringify({
          type: 'led_control',
          led: led
        }));
      }

      function updateLedStatus(ledStates) {
        console.log('Updating LED button states', ledStates);

            // Ensure LED states array has the correct length (5 LEDs in total)
        if (ledStates.length !== 5) {
          console.error('Invalid LED states array:', ledStates);
           return;
        }
        
        for (let i = 1; i <= 5; i++) {
          const ledBtn = document.getElementById(`led${i}`);
          if (ledStates[i - 1] === 1) {
            ledBtn.classList.add('active');
            ledBtn.classList.remove('inactive');
          } else {
            ledBtn.classList.add('inactive');
            ledBtn.classList.remove('active');
          }
        }
      }

    </script>
    <script>
      // Smooth scrolling
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });
    </script>
  </body>
</html>
